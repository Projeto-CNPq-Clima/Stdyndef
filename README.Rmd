---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Stdyndef

<!-- badges: start -->
<!-- badges: end -->

# Stdyndef: Spatiotemporal Modeling with Dynamic Deformation for Nonstationary Covariance Structures

The `Stdyndef` package implements a novel spatiotemporal modeling framework with dynamic deformation, allowing for nonstationary covariance structures. This innovative approach is ideal for analyzing spatiotemporal data with evolving spatial relationships, such as monthly average temperature data.

## Installation


You can install the development version of Stdyndef from [GitHub](https://github.com/Projeto-CNPq-Clima/Stdyndef) with:

```r
# install.packages("pak")
pak::pak("Projeto-CNPq-Clima/Stdyndef")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(Stdyndef)
## basic example code
# Load sample data
data(temperature)
data(FT)
data(MatFFT)
data(GT)
data(sites)
data(GAMA)
data(Map)

# Fit the model
Mod <- SpatialDeformationMCMC(
  response = temperature,
  FT = FT,
  MatFFT = MatFFT,
  GT = GT,
  sites = sites,
  GAMA = GAMA,
  iteration = 100,
  burnin = 50,
  jump = 2
)

# Compute deformations on a 10x10 grid
Mmd <- compute_Mmd(Mod, temperature, sites, Map, dd = 10)

# Plot results for the first deformation
x <- Mmd[1:(nrow(Mmd) / 2), 1]
y <- Mmd[(nrow(Mmd) / 2 + 1):nrow(Mmd), 1]
plot(x, y, type = "l", main = "Dynamic Deformation", xlab = "Longitude", ylab = "Latitude")

# Calculate DIC
dic_results <- DIC(
  MCMC_output = Mod,
  response = temperature,
  FT = FT,
  MatFFT = MatFFT,
  GT = GT,
  sites = sites,
  GAMA = GAMA
)

# View results
print(dic_results)


?SpatialDeformationMCMC
?compute_Mmd
?DIC
```

